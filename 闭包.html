<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

</body>
<!-- 闭包 -->
<script>
    //闭包函数：声明在一个函数中的函数，叫做闭包函数。

    // 闭包：内部函数总是可以访问其所在的外部函数中声明的参数和变量，即使在其外部函数被返回（寿命终结）了之后。
    //特点
    // 让函数外部访问函数内部变量成为可能；

    // 局部变量会常驻在内存中；

    // 可以避免使用全局变量，防止全局变量污染；

    // 会造成内存泄漏（有一块内存空间被长期占用，而不被释放）

    // 闭包是在函数外部访问函数内部的变量 防止全局变量溢出
    //每次外部函数执行的时 候，外部函数的引用地址不同，都会重新创建一个新的地址。
    function fn() {
        var bb = 'aaa'
        return bb;
    }
    var aa = fn();
    console.log(aa, window.bb) // aaa undefined，内部变量return出来
        // 功能：输入框输入字段需要接口校验 将错误的值缓存起来 减少接口的调用
    var bibao = (function fn1(val) {
        var arr = []
        return {
            fn1: function(val) {
                if (arr.indexOf(val) == -1) {
                    arr.push(val)
                }
                return arr
            }
        }
    })()
    var a1 = bibao.fn1('1')
    a1 = bibao.fn1('2') // 销毁第一个
        // 清除闭包：创建闭包的变量bibao=null 或者重新创建闭包 会销毁上一个闭包  （变量不被引用会被回收）
        // 下面是不使用闭包
        // function fn1() {
        //     var _this = this
        //     _this.arr = []
        //     _this.fn2 = function(val) {
        //         if (_this.arr.indexOf(val) == -1) {
        //             _this.arr.push(val)
        //         }
        //         return _this.arr
        //     }
        // }
        // var a1 = new fn1()
        // console.log(a1.fn2('1'))
</script>

</html>