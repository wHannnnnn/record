<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

</body>
<!-- 实现一个new   .call  .apply  instanceOf-->
<script>
    function myNew(fn, ...args) {
        var obj = Object.create(fn.prototype);
        let result = fn.apply(obj, args)
        return typeof result === 'object' ? result : obj;
    }
    Function.prototype.call = function(context, ...args) {
        context = context || window
        context.fn = this // 这里的this代表函数
        var result = context.fn(...args) // 给context添加属性fn，所以执行fn方法时，里面的this代表context
        delete context.fn
        return result
    }
    Function.prototype.apply = function(context, arr) {
            context = context || window
            context.fn = this
            var result = context.fn(...arr)
            delete context.fn
            return result
        }
        // 简单版
    Function.prototype.abind = function(context, ...args) {
            var fn = this
            return function(...args1) {
                return fn.apply(context, [...args, ...args1])
            }
        }
        // 考虑new 原型
    Function.prototype.bind_ = function(obj, ...args) {
        var fn = this;
        var bound = function(...args1) {
            //通过constructor判断调用方式，为true this指向实例，否则为obj
            console.log(this.constructor === fn)
            fn.apply(this.constructor === fn ? this : obj, args.concat(args1));
        };
        var f = Object.create(fn.prototype);
        bound.prototype = f;
        return bound;
    };

    function instance(l, r) {
        var newL = l.__proto__;
        var newR = r.prototype;
        while (true) {
            if (newL === null) return false;
            if (newL === newR) return true;
            newL = newL.__proto__;
        }
    }
    Array.prototype.reduce = function(fn, initVal) {
        let pre = initVal ? initVal : this[0];
        for (let i = initVal ? 0 : 1; i < this.length; i++) {
            pre = fn(pre, this[i], i, this);
        }
        return pre;
    }
</script>

</html>